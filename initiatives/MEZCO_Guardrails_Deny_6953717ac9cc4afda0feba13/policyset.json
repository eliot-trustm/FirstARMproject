{
 "properties": {
  "displayName": "MEZCO Guardrails Deny",
  "policyType": "Custom",
  "description": "",
  "metadata": {
   "category": "General",
   "version": "1",
   "createdBy": "b9a81bd6-d631-4270-9186-070229a959be",
   "createdOn": "2023-03-22T11:51:57.6386625Z",
   "updatedBy": "b9a81bd6-d631-4270-9186-070229a959be",
   "updatedOn": "2023-03-22T12:22:26.7501561Z"
  },
  "parameters": {
   "Storage accounts should restrict network access using virtual network rules": {
    "type": "string",
    "metadata": {
     "displayName": "Storage accounts should restrict network access using virtual network rules",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Key vaults should have purge protection enabled": {
    "type": "string",
    "metadata": {
     "displayName": "Key vaults should have purge protection enabled",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "App Service apps should require FTPS only": {
    "type": "string",
    "metadata": {
     "displayName": "App Service apps should require FTPS only",
     "description": null
    },
    "allowedValues": [
     "AuditIfNotExists",
     "Disabled"
    ],
    "defaultValue": "AuditIfNotExists"
   },
   "Function apps should require FTPS only": {
    "type": "string",
    "metadata": {
     "displayName": "Function apps should require FTPS only",
     "description": null
    },
    "allowedValues": [
     "AuditIfNotExists",
     "Disabled"
    ],
    "defaultValue": "AuditIfNotExists"
   },
   "Function apps should only be accessible over HTTPS": {
    "type": "string",
    "metadata": {
     "displayName": "Function apps should only be accessible over HTTPS",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Disabled",
     "Deny"
    ],
    "defaultValue": "Deny"
   },
   "App Service apps should only be accessible over HTTPS": {
    "type": "string",
    "metadata": {
     "displayName": "App Service apps should only be accessible over HTTPS",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Azure Key Vault should have firewall enabled": {
    "type": "string",
    "metadata": {
     "displayName": "Azure Key Vault should have firewall enabled",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Public network access on Azure SQL Database should be disabled": {
    "type": "string",
    "metadata": {
     "displayName": "Public network access on Azure SQL Database should be disabled",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Secure transfer to storage accounts should be enabled": {
    "type": "string",
    "metadata": {
     "displayName": "Secure transfer to storage accounts should be enabled",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Container registries should not allow unrestricted network access": {
    "type": "string",
    "metadata": {
     "displayName": "Container registries should not allow unrestricted network access",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Public network access should be disabled for PostgreSQL servers": {
    "type": "string",
    "metadata": {
     "displayName": "Public network access should be disabled for PostgreSQL servers",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Web Application Firewall (WAF) should be enabled for Application Gateway": {
    "type": "string",
    "metadata": {
     "displayName": "Web Application Firewall (WAF) should be enabled for Application Gateway",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Azure Web Application Firewall should be enabled for Azure Front Door entry-points": {
    "type": "string",
    "metadata": {
     "displayName": "Azure Web Application Firewall should be enabled for Azure Front Door entry-points",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Public network access should be disabled for MySQL servers": {
    "type": "string",
    "metadata": {
     "displayName": "Public network access should be disabled for MySQL servers",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Transparent Data Encryption on SQL databases should be enabled": {
    "type": "string",
    "metadata": {
     "displayName": "Transparent Data Encryption on SQL databases should be enabled",
     "description": null
    },
    "allowedValues": [
     "AuditIfNotExists",
     "Disabled"
    ],
    "defaultValue": "AuditIfNotExists"
   },
   "Azure Cosmos DB accounts should have firewall rules": {
    "type": "string",
    "metadata": {
     "displayName": "Azure Cosmos DB accounts should have firewall rules",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Cognitive Services accounts should disable public network access": {
    "type": "string",
    "metadata": {
     "displayName": "Cognitive Services accounts should disable public network access",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   },
   "Cognitive Services accounts should restrict network access": {
    "type": "string",
    "metadata": {
     "displayName": "Cognitive Services accounts should restrict network access",
     "description": null
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Deny"
   }
  },
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Storage accounts should restrict network access using virtual network rules_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
    "parameters": {
     "effect": {
      "value": "[parameters('Storage accounts should restrict network access using virtual network rules')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Key vaults should have purge protection enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
    "parameters": {
     "effect": {
      "value": "[parameters('Key vaults should have purge protection enabled')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "App Service apps should require FTPS only_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
    "parameters": {
     "effect": {
      "value": "[parameters('App Service apps should require FTPS only')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Function apps should require FTPS only_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
    "parameters": {
     "effect": {
      "value": "[parameters('Function apps should require FTPS only')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Function apps should only be accessible over HTTPS_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
    "parameters": {
     "effect": {
      "value": "[parameters('Function apps should only be accessible over HTTPS')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "App Service apps should only be accessible over HTTPS_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
    "parameters": {
     "effect": {
      "value": "[parameters('App Service apps should only be accessible over HTTPS')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Key Vault should have firewall enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
    "parameters": {
     "effect": {
      "value": "[parameters('Azure Key Vault should have firewall enabled')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access on Azure SQL Database should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
    "parameters": {
     "effect": {
      "value": "[parameters('Public network access on Azure SQL Database should be disabled')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "parameters": {
     "effect": {
      "value": "[parameters('Secure transfer to storage accounts should be enabled')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Container registries should not allow unrestricted network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
    "parameters": {
     "effect": {
      "value": "[parameters('Container registries should not allow unrestricted network access')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for PostgreSQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
    "parameters": {
     "effect": {
      "value": "[parameters('Public network access should be disabled for PostgreSQL servers')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Web Application Firewall (WAF) should be enabled for Application Gateway_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
    "parameters": {
     "effect": {
      "value": "[parameters('Web Application Firewall (WAF) should be enabled for Application Gateway')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Web Application Firewall should be enabled for Azure Front Door entry-points_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
    "parameters": {
     "effect": {
      "value": "[parameters('Azure Web Application Firewall should be enabled for Azure Front Door entry-points')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for MySQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
    "parameters": {
     "effect": {
      "value": "[parameters('Public network access should be disabled for MySQL servers')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Transparent Data Encryption on SQL databases should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
    "parameters": {
     "effect": {
      "value": "[parameters('Transparent Data Encryption on SQL databases should be enabled')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Cosmos DB accounts should have firewall rules_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
    "parameters": {
     "effect": {
      "value": "[parameters('Azure Cosmos DB accounts should have firewall rules')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Cognitive Services accounts should disable public network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca",
    "parameters": {
     "effect": {
      "value": "[parameters('Cognitive Services accounts should disable public network access')]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Cognitive Services accounts should restrict network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
    "parameters": {
     "effect": {
      "value": "[parameters('Cognitive Services accounts should restrict network access')]"
     }
    },
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/subscriptions/8441b620-a422-4f90-9f56-b5f8bfa8e122/providers/Microsoft.Authorization/policySetDefinitions/6953717ac9cc4afda0feba13",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "6953717ac9cc4afda0feba13"
}